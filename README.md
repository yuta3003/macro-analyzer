# Excel VBA マクロ抽出ツール

## プロジェクト概要

このツールは、Excel ファイル（.xlsm）から VBA マクロを抽出し、表示するための Python アプリケーションです。特に「計測器貸出管理.xlsm」ファイルを対象に、含まれる VBA マクロコードを解析・表示します。

主な機能:
- Excel ファイルから VBA マクロの検出
- 検出されたマクロコードの抽出と表示
- マクロファイル名とコードの整形表示

## セットアップ手順

### 前提条件

- Python 3.6 以上
- pip (Python パッケージマネージャー)

### インストール方法

1. リポジトリをクローンする
```bash
git clone [リポジトリURL]
cd [リポジトリ名]
```

2. 仮想環境を作成する（推奨）
```bash
python -m venv venv
```

3. 仮想環境を有効化する
   - Windows:
   ```bash
   venv\Scripts\activate
   ```
   - macOS/Linux:
   ```bash
   source venv/bin/activate
   ```

4. 必要なパッケージをインストールする
```bash
pip install -r requirements.txt
```

## 使用技術／依存ライブラリ

このプロジェクトは以下の主要なライブラリに依存しています：

- **oletools (0.60.2)**: OLE および MS Office ファイルを解析するためのツール
- **msoffcrypto-tool (5.4.2)**: MS Office ファイルの暗号化を処理するためのツール
- **olefile (0.47)**: OLE ファイルを読み取るためのパッケージ
- **pcodedmp (1.2.6)**: VBA P-code の逆アセンブルツール
- **cryptography (45.0.4)**: 暗号化機能を提供するライブラリ

その他の依存関係については `requirements.txt` ファイルを参照してください。

## 実行方法

### 基本的な使用方法

1. 解析したい Excel ファイルを準備します（デフォルトでは「計測器貸出管理.xlsm」を使用）

2. 以下のコマンドを実行します：
```bash
python main.py
```

3. 検出されたマクロが標準出力に表示されます

### カスタム使用方法

異なる Excel ファイルを解析する場合は、`main.py` の以下の行を編集してください：

```python
vba_parser = VBA_Parser("計測器貸出管理.xlsm")
```

ファイルパスを解析したいファイルのパスに変更します。

## 開発環境

- Python 3.6+
- 任意のコードエディタ（VS Code 推奨）
- 仮想環境での開発を推奨

## 将来の拡張予定

- FastAPI を使用した Web インターフェースの追加
- MySQL データベースとの連携による解析結果の保存機能
- バッチ処理による複数ファイルの一括解析

## ライセンス

[ライセンス情報をここに記載]

## 連絡先

[連絡先情報をここに記載]

## 注意事項

- `.env` ファイルは含まれていません。必要に応じて `.env.example` を参考に作成してください。
- マクロを含む Excel ファイルの取り扱いには十分注意してください。